import{a as M,b as E,k as O,l as I,m as A,p as L,F as _,_ as N,y as T,q as D,v as k,o as i,w as F}from"./index.165f1bc1.js";import{Q as S,u as C,b as R,P as p,a as y}from"./index.f889dc5c.js";var V=function(r){M(h,r);function h(n,e){return r.call(this,n,e)||this}var s=h.prototype;return s.bindMethods=function(){r.prototype.bindMethods.call(this),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)},s.setOptions=function(e,c){r.prototype.setOptions.call(this,E({},e,{behavior:O()}),c)},s.getOptimisticResult=function(e){return e.behavior=O(),r.prototype.getOptimisticResult.call(this,e)},s.fetchNextPage=function(e){var c;return this.fetch({cancelRefetch:(c=e==null?void 0:e.cancelRefetch)!=null?c:!0,throwOnError:e==null?void 0:e.throwOnError,meta:{fetchMore:{direction:"forward",pageParam:e==null?void 0:e.pageParam}}})},s.fetchPreviousPage=function(e){var c;return this.fetch({cancelRefetch:(c=e==null?void 0:e.cancelRefetch)!=null?c:!0,throwOnError:e==null?void 0:e.throwOnError,meta:{fetchMore:{direction:"backward",pageParam:e==null?void 0:e.pageParam}}})},s.createResult=function(e,c){var u,m,v,d,g,P,a=e.state,o=r.prototype.createResult.call(this,e,c);return E({},o,{fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:I(c,(u=a.data)==null?void 0:u.pages),hasPreviousPage:A(c,(m=a.data)==null?void 0:m.pages),isFetchingNextPage:a.isFetching&&((v=a.fetchMeta)==null||(d=v.fetchMore)==null?void 0:d.direction)==="forward",isFetchingPreviousPage:a.isFetching&&((g=a.fetchMeta)==null||(P=g.fetchMore)==null?void 0:P.direction)==="backward"})},h}(S);function B(r,h,s){var n=L(r,h,s);return C(n,V)}const Q=_(()=>N(()=>import("./PageBreak.bad00dbf.js"),["assets/PageBreak.bad00dbf.js","assets/index.165f1bc1.js","assets/index.687e1d9a.css"])),H=_(()=>N(()=>import("./PageHeader.cf068e14.js"),["assets/PageHeader.cf068e14.js","assets/index.165f1bc1.js","assets/index.687e1d9a.css"])),W=_(()=>N(()=>import("./Post.264d1893.js"),["assets/Post.264d1893.js","assets/index.165f1bc1.js","assets/index.687e1d9a.css"])),b=_(()=>N(()=>import("./index.165f1bc1.js").then(r=>r.x),["assets/index.165f1bc1.js","assets/index.687e1d9a.css"]));function j(){var P;const[r,h]=T(0),{id:s}=D(),n=k(),{category:e}=n.state,c=async({pageParam:a=`${R}?categories=${s}&per_page=${p}&offset=${r}`})=>{try{h(t=>t+p);const{data:o}=await y.get(a),w=o.map(t=>{var l,f;return(f=(l=t==null?void 0:t._links)==null?void 0:l["wp:featuredmedia"][0])==null?void 0:f.href}),$=await Promise.all(w.map(t=>y.get(t))),x=$==null?void 0:$.map(({data:t})=>{var l;return{id:t==null?void 0:t.id,url:(l=t==null?void 0:t.guid)==null?void 0:l.rendered}});return{posts:o.map(t=>{var l;return{...t,imageUrl:(l=x==null?void 0:x.find(f=>(f==null?void 0:f.id)===(t==null?void 0:t.featured_media)))==null?void 0:l.url}}),nextCursor:r}}catch(o){console.error(o)}},{data:u,isLoading:m,fetchNextPage:v,hasNextPage:d,isFetchingNextPage:g}=B(`posts-from-category-${s}`,({pageParam:a=`${R}?categories=${s}&per_page=${p}&offset=${r}`})=>c(a),{getNextPageParam:a=>a==null?void 0:a.nextCursor});return i("article",{className:"w-full h-full py-8",children:[i(H,{title:e}),i(Q,{}),m?i("div",{className:"spinner-container",children:i(b,{})}):i(F,{children:[i("ul",{className:"grid grid-cols-1 gap-12 lg:gap-8 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 px-6 h-full",children:(P=u==null?void 0:u.pages)==null?void 0:P.map(a=>a==null?void 0:a.posts.map(o=>i(W,{post:o},o.id)))}),i("div",{className:"text-center mt-8 z-10",children:g?i("div",{className:"spinner-container",children:i(b,{})}):d?i("button",{className:"btn-primary",onClick:()=>v({pageParam:`${R}?categories=${s}&per_page=${p}&offset=${r}`}),disabled:!d||g,children:i("span",{className:"btn-secondary",children:"Load more"})}):i("h1",{className:"btn-terinary",children:"Nothing more to load"})})]})]})}export{j as default};
