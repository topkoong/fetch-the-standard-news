import{b as M,c as R,l as E,m as I,o as A,a as L,U as _,_ as N,p as T,q as D,v as k,e as i,w as F}from"./index.e5421068.js";import{Q as S,u as C,b,P as p,a as O}from"./index.a7cf54fe.js";var V=function(a){M(h,a);function h(n,e){return a.call(this,n,e)||this}var s=h.prototype;return s.bindMethods=function(){a.prototype.bindMethods.call(this),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)},s.setOptions=function(e,c){a.prototype.setOptions.call(this,R({},e,{behavior:E()}),c)},s.getOptimisticResult=function(e){return e.behavior=E(),a.prototype.getOptimisticResult.call(this,e)},s.fetchNextPage=function(e){var c;return this.fetch({cancelRefetch:(c=e==null?void 0:e.cancelRefetch)!=null?c:!0,throwOnError:e==null?void 0:e.throwOnError,meta:{fetchMore:{direction:"forward",pageParam:e==null?void 0:e.pageParam}}})},s.fetchPreviousPage=function(e){var c;return this.fetch({cancelRefetch:(c=e==null?void 0:e.cancelRefetch)!=null?c:!0,throwOnError:e==null?void 0:e.throwOnError,meta:{fetchMore:{direction:"backward",pageParam:e==null?void 0:e.pageParam}}})},s.createResult=function(e,c){var u,m,v,d,g,P,r=e.state,o=a.prototype.createResult.call(this,e,c);return R({},o,{fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:I(c,(u=r.data)==null?void 0:u.pages),hasPreviousPage:A(c,(m=r.data)==null?void 0:m.pages),isFetchingNextPage:r.isFetching&&((v=r.fetchMeta)==null||(d=v.fetchMore)==null?void 0:d.direction)==="forward",isFetchingPreviousPage:r.isFetching&&((g=r.fetchMeta)==null||(P=g.fetchMore)==null?void 0:P.direction)==="backward"})},h}(S);function B(a,h,s){var n=L(a,h,s);return C(n,V)}const Q=_(()=>N(()=>import("./PageBreak.9126526a.js"),["assets/PageBreak.9126526a.js","assets/index.e5421068.js","assets/index.308ca3e4.css"])),H=_(()=>N(()=>import("./PageHeader.e4217e1d.js"),["assets/PageHeader.e4217e1d.js","assets/index.e5421068.js","assets/index.308ca3e4.css"])),W=_(()=>N(()=>import("./Post.f01aedeb.js"),["assets/Post.f01aedeb.js","assets/index.e5421068.js","assets/index.308ca3e4.css"])),y=_(()=>N(()=>import("./index.e5421068.js").then(a=>a.y),["assets/index.e5421068.js","assets/index.308ca3e4.css"]));function j(){var P;const[a,h]=T(0),{id:s}=D(),n=k(),{category:e}=n.state,c=async({pageParam:r=`${b}?categories=${s}&per_page=${p}&offset=${a}`})=>{try{h(t=>t+p);const{data:o}=await O.get(r),w=o.map(t=>{var l,f;return(f=(l=t==null?void 0:t._links)==null?void 0:l["wp:featuredmedia"][0])==null?void 0:f.href}),$=await Promise.all(w.map(t=>O.get(t))),x=$==null?void 0:$.map(({data:t})=>{var l;return{id:t==null?void 0:t.id,url:(l=t==null?void 0:t.guid)==null?void 0:l.rendered}});return{posts:o.map(t=>{var l;return{...t,imageUrl:(l=x==null?void 0:x.find(f=>(f==null?void 0:f.id)===(t==null?void 0:t.featured_media)))==null?void 0:l.url}}),nextCursor:a}}catch(o){console.error(o)}},{data:u,isLoading:m,fetchNextPage:v,hasNextPage:d,isFetchingNextPage:g}=B(`posts-from-category-${s}`,({pageParam:r=`${b}?categories=${s}&per_page=${p}&offset=${a}`})=>c(r),{getNextPageParam:r=>r==null?void 0:r.nextCursor});return i("article",{className:"bg-bright-blue w-full h-full py-8",children:[i(H,{title:e}),i(Q,{}),m?i("div",{className:"spinner-container",children:i(y,{})}):i(F,{children:[i("ul",{className:"grid grid-cols-1 gap-12 lg:gap-8 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 px-6 h-full",children:(P=u==null?void 0:u.pages)==null?void 0:P.map(r=>r==null?void 0:r.posts.map(o=>i(W,{post:o},o.id)))}),i("div",{className:"text-center mt-8 z-10",children:g?i("div",{className:"spinner-container",children:i(y,{})}):d?i("button",{className:"btn-primary",onClick:()=>v({pageParam:`${b}?categories=${s}&per_page=${p}&offset=${a}`}),disabled:!d||g,children:i("span",{className:"btn-secondary",children:"Load more"})}):i("h1",{className:"btn-terinary",children:"Nothing more to load"})})]})]})}export{j as default};
